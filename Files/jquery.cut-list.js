!function(t){t.fn.cutList=function(){var i=function(t,i){var s,e={};for(s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);for(s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s]);return e}({moreBtnTitle:"Еще",showMoreOnHover:!1,alwaysVisibleElem:void 0,risezeDelay:50},arguments[0]);return this.each(function(){var s,e,n,o,d,l=t(this),r=t(this).clone();function c(){clearTimeout(d),d=setTimeout(function(){var i;i=l,s,t.when(function(i){i.find(".cut-list__more .cut-list__elem").each(function(){var s=t(this).data("index");0==s?t(this).prependTo(i):t(this).insertAfter(i.find('.cut-list__elem[data-index="'+(s-1)+'"]'))})}(i)).done(function(){a(i)})},i.risezeDelay)}function _(e){e.find(".cut-list__dropdown").length||e.append('<div style="display:none" class="cut-list__elem cut-list__dropdown"></div>').find(".cut-list__dropdown").append('<div class="cut-list__drop"></div>').find(".cut-list__drop").append('<div class="cut-list__drop-toggle">'+i.moreBtnTitle+"</div>").append('<div class="cut-list__more"><div class="cut-list__more-content"></div></div>'),e.addClass("cut-list").children().each(function(i){t(this).attr("data-index",i).addClass("cut-list__elem")}),s=e.find(".cut-list__elem").length,index=s-1,e.find(i.alwaysVisibleElem).length>1&&console.log("Внимание! Вами назначено несколько alwaysVisibleElem, будет использоваться только первый."),o=e.find(i.alwaysVisibleElem+":first").index(),a(e),i.showMoreOnHover?e.find(".cut-list__drop").hover(function(){t(this).parents(".cut-list__dropdown").addClass("is-show"),u(t(this).parents(".cut-list__dropdown").find(".cut-list__more"))},function(){t(this).parents(".cut-list__dropdown").removeClass("is-show").find(".cut-list__more").hide().removeClass("is-top is-left")}):(e.find(".cut-list__drop-toggle").on("click",function(){t(this).parents(".cut-list__dropdown").is(".is-show")?t(this).parents(".cut-list__dropdown").removeClass("is-show").find(".cut-list__more").hide().removeClass("is-top is-left"):(t(this).parents(".cut-list__dropdown").addClass("is-show"),u(t(this).parents(".cut-list__dropdown").find(".cut-list__more")))}),t(document).on("click",function(i){t(i.target).closest(".cut-list__dropdown").length||t(".cut-list__dropdown.is-show").removeClass("is-show").find(".cut-list__more").hide().removeClass("is-top is-left")})),t(window).on("resize",c)}function a(d){e=d.innerWidth(),n=d.find(".cut-list__dropdown").outerWidth(!0);var l='.cut-list__elem:not(".cut-list__dropdown")';-1!=o&&(n+=d.find(i.alwaysVisibleElem+":first").outerWidth(!0),l='.cut-list__elem:not(".cut-list__dropdown,'+i.alwaysVisibleElem+':first")'),d.find(l).each(function(l){if((n+=t(this).outerWidth(!0))>=e)return function(t,d){var l='.cut-list__elem:not(".cut-list__dropdown")';-1!=o&&(l='.cut-list__elem:not(".cut-list__dropdown,'+i.alwaysVisibleElem+':first")');for(x=d;x<=s;x++)t.find(l+'[data-index="'+x+'"]').appendTo(t.find(".cut-list__more-content"));-1!=o&&t.find(".cut-list__elem:first").is(i.alwaysVisibleElem)&&(e=t.innerWidth(),(n=t.find(".cut-list__dropdown").outerWidth(!0)+t.find(i.alwaysVisibleElem+":first").outerWidth(!0))>=e&&t.find('.cut-list__elem:not(".cut-list__dropdown")[data-index="'+t.find(i.alwaysVisibleElem+":first").data("index")+'"]').appendTo(t.find(".cut-list__more-content")))}(d,-1!=o&&l>o?l+1:l),d.addClass("with-more-items").find(".cut-list__dropdown").show(),!1;d.removeClass("with-more-items").find(".cut-list__dropdown").hide()})}function u(i){var s=t(document).outerHeight(!0);i.css("visibility","hidden").show(),i.offset().top+i.innerHeight()>s&&i.addClass("is-top"),i.offset().left<0&&i.addClass("is-left"),i.css("visibility","visible")}_(l),t.fn.cutList.setup=function(){_(l)},t.fn.cutList.destroy=function(){l.html(r.html()),t(window).off("resize",c)}})}}($);
